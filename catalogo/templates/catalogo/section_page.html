{% extends "catalogo/base.html" %}
{% load static %}

{% block title %}{{ titulo_seccion }}{% endblock %}

{% block content %}
<div class="container section-page-container">
    <h1 class="section-title">{{ titulo_seccion }}</h1>

    {% if error_carga %}
        <p class="message message--error">There was a problem loading the content. Please try again later or contact the administrator.</p>
    {% elif items or resultados %}
        <div class="card-grid" id="content-grid">
            {% with items_to_display=items|default:resultados %}
                {% for item in items_to_display %}
                    {% comment %} Determine the correct detail URL {% endcomment %}
                    {% if item.tipo == 'pelicula' or not item.tipo and tipo_contenido == 'peliculas' %}
                        {% url 'catalogo:movie_detail' item_id=item.id as final_detail_url %}
                        {% include "./partials/card.html" with item=item detail_url=final_detail_url %}
                    {% elif item.tipo == 'serie' or not item.tipo and tipo_contenido == 'series' %}
                        {% url 'catalogo:serie_detail' item_id=item.id as final_detail_url %}
                        {% include "./partials/card.html" with item=item detail_url=final_detail_url %}
                    {% elif item.tipo == 'anime' or not item.tipo and tipo_contenido == 'anime' %}
                        {% url 'catalogo:anime_detail' item_id=item.id as final_detail_url %}
                        {% include "./partials/card.html" with item=item detail_url=final_detail_url %}
                    {% else %}
                        {% include "./partials/card.html" with item=item detail_url="#" %}
                    {% endif %}
                {% endfor %}
            {% endwith %}
        </div>
        {% if tipo_contenido != 'search' and items and items|length > 0 %}
        <button id="show-more-btn" class="button button--primary button--load-more">Show more</button>
        {% endif %}
    {% else %}
        <p class="message">
            {% if query %}
                No results found for "{{ query }}". Try different terms.
            {% else %}
                No content available in this section at the moment.
            {% endif %}
        </p>
    {% endif %}

    <aside class="ad-space ad-sidebar">
        <span>Sidebar Advertisement</span>
    </aside>
</div>
{% endblock %}
